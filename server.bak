// Hono ã¨ã„ã†ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’èª­ã¿è¾¼ã‚€
// â†’ APIã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ç°¡å˜ã«æ›¸ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹éƒ¨å“
import { Hono } from 'hono'

// Node.js ä¸Šã§ Hono ã‚’ã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦èµ·å‹•ã™ã‚‹ãŸã‚ã®éƒ¨å“
import { serve } from '@hono/node-server'

// .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
// â†’ APIã‚­ãƒ¼ãªã©ã®ç§˜å¯†æƒ…å ±ã‚’ process.env ã«å–ã‚Šè¾¼ã‚€
import 'dotenv/config'

// Hono ã‚¢ãƒ—ãƒªï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰ã®æœ¬ä½“ã‚’ä½œã‚‹
const app = new Hono()

// =====================
// ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç”¨API
// =====================
// ã€Œ/healthã€ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ãã« { ok: true } ã‚’è¿”ã™
// â†’ ã‚µãƒ¼ãƒãƒ¼ãŒå‹•ã„ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ãŸã‚ã®ç°¡å˜ãªAPI
app.get('/health', (c) => c.json({ ok: true }))

// =====================
// ãƒ¢ãƒƒã‚¯ã®ã‚«ãƒ†ã‚´ãƒªãƒ‡ãƒ¼ã‚¿
// =====================
// æœ¬æ¥ã¯DBã‹ã‚‰å–ã£ã¦ãã‚‹ãŒã€Phase1ã§ã¯é…åˆ—ã«ç›´æŽ¥æ›¸ã„ã¦ãŠã
// created_at, updated_at ã‚‚æ–‡å­—åˆ—ã§é©å½“ã«å…¥ã‚Œã¦ã„ã‚‹
const categories = [
  { id: 1, name: 'AI', slug: 'ai', created_at: '2025-08-01T00:00:00Z', updated_at: '2025-08-01T00:00:00Z' },
  { id: 2, name: 'Finance', slug: 'finance', created_at: '2025-08-01T00:00:00Z', updated_at: '2025-08-01T00:00:00Z' },
  { id: 3, name: 'Technology', slug: 'technology', created_at: '2025-08-01T00:00:00Z', updated_at: '2025-08-01T00:00:00Z' },
]

// =====================
// ã‚«ãƒ†ã‚´ãƒªä¸€è¦§API
// =====================
// ã€Œ/categoriesã€ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ãã« categories é…åˆ—ã‚’è¿”ã™
// total ã¯ä»¶æ•°ã‚’è¿”ã™
app.get('/categories', (c) => {
  return c.json({
    ok: true,                  // æˆåŠŸã—ãŸã‚ˆã€ã®ãƒ•ãƒ©ã‚°
    items: categories,         // ã‚«ãƒ†ã‚´ãƒªã®é…åˆ—
    total: categories.length,  // ç·ä»¶æ•°
  })
})

// =====================
// ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã™ã‚‹å‡¦ç†
// =====================
// ãƒãƒ¼ãƒˆ3000ç•ªã§ç«‹ã¡ä¸Šã’ã‚‹ï¼ˆhttp://localhost:3000ï¼‰
// èµ·å‹•ã—ãŸã‚‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°ã‚’å‡ºã™
serve({ fetch: app.fetch, port: 3000 }, (info) => {
  console.log(`ðŸš€ Hono API running at http://localhost:${info.port}`)
})

